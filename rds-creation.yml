---
AWSTemplateFormatVersion: "2010-09-09"

Description: >
  The template is used to create a VPC with CIDR provided as parameter.

# Metadata:
#   template metadata

Parameters:
  secDBPrivate:
     Description: The secDBPrivate
     Type: String
  rdsDBSubnetGroup:
     Description: The rdsDBSubnetGroup
     Type: String
  AZ:
    Description: The availability zone
    Type: String
  Environment:
    Description: The application environment
    Type: String

  

Resources:

  rdsDBInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      AllocatedStorage: 20
      DBInstanceClass: db.t3.micro
      AvailabilityZone: !Ref AZ
      BackupRetentionPeriod: 0
      DBInstanceIdentifier: !Join [ "-", [!Ref Environment,"database" ] ]
      DBSubnetGroupName: !Ref rdsDBSubnetGroup
      Engine: mysql
      EngineVersion: 8.0.28
      # KmsKeyId: 
      # LicenseModel: 
      MasterUsername: admin
      MasterUserPassword: password
      MultiAZ: false
      # OptionGroupName: 
      Port: 3306
      EnablePerformanceInsights: false
      # PreferredBackupWindow: 
      # PreferredMaintenanceWindow: 
      PubliclyAccessible: false
      # SourceDBInstanceIdentifier: 
      StorageEncrypted: false
      StorageType: gp2
      VPCSecurityGroups:
        - !Ref secDBPrivate
      Tags:
        - Key: Name
          Value: !Join [ "-", [ "rds",!Ref AZ,!Ref Environment,"database" ] ]

# Outputs:
#   set of outputs